language: python
python:
  - "3.6"
install:
  - pip install cfn-lint taskcat awscli

git:
    submodules: false
before_install:
    - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
    - git submodule update --init --recursive

before_script:
  - BRANCH=test make sync
script:
  - make lint
  - make test

deploy:
  provider: script
  script: BRANCH=$TRAVIS_BRANCH make sync
  on:
    branch:
      - master
      - develop
